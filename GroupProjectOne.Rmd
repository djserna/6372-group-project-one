---
title: "Group Project One"
author: "Daniel Serna and Laura Niederlander"
date: "September 16, 2018"
output: html_document
---

```{r importData}
trainData <- read.csv("train.csv")

head(trainData)

```

```{r addUtilityFunctions}
panel.hist <- function(x, ...)
{
    usr <- par("usr"); on.exit(par(usr))
    par(usr = c(usr[1:2], 0, 1.5) )
    h <- hist(x, plot = FALSE)
    breaks <- h$breaks; nB <- length(breaks)
    y <- h$counts; y <- y/max(y)
    rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
```

```{r removeOutliers}
trainData <- trainData[trainData$build_year >= 1691,]
trainData <- trainData[trainData$build_year <= 2018,]
trainData <- trainData[trainData$full_sq <= 5000,]
trainData <- trainData[trainData$kitch_sq <= 1500,]
trainData <- trainData[trainData$life_sq <= 1000,]
trainData <- trainData[trainData$state <= 4,]
```

```{r dataAnalysis}
pairs(~price_doc+full_sq+life_sq+floor+max_floor+material+build_year+num_room+kitch_sq+state,data=trainData, 
   main="Simple Scatterplot Matrix", diag.panel=panel.hist)
```

```{r dataAnalysis}
pairs(~price_doc+full_sq+life_sq+floor+build_year+
        num_room+kitch_sq+state,data=trainData, 
   main="Simple Scatterplot Matrix", diag.panel=panel.hist)

```

```{r missing values}
library(tidyverse)

traindata2 <- trainData %>%
  group_by(build_year, state) %>%
summarize(mean = mean(price_doc, na.rm= TRUE))



head(traindata2)

##**/Code for Stepwise/forward

##Full model;

proc reg data = newintAlcohol;                                                                                                             
model Metabol = Gastric SexCross AlcoholicC FA GF GA GAF;                                                                                                                                                                
run;  

##Reduced model;

proc reg data = newintAlcohol;                                                                                                             
model Metabol = Gastric SexCross GF;                                                                                                                                                                
run;

##In GLM;

proc glm data = newintAlcohol;                                                                                                          
class Sex Alcoholic;                                                                                                                    
model Metabol = Gastric | Sex | Alcoholic / solution;                                                                                   
run; 
```






